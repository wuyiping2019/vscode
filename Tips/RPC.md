# day01 RPC的简单介绍

<https://zhuanlan.zhihu.com/p/139688497>  
RPC框架---远程过程调用协议RPC（Remote Procedure Call Protocol)---允许像调用本地服务一样调用远程服务。  
RPC是指远程过程调用，也就是说两台服务器A、B，一个应用部署在A服务器上，想要调用B服务器上应用提供的函数/方法，由于不在一个内存空间，不能直接调用，需要通过网络来表达调用的语义和传达调用的数据。  
比如说，一个方法可能是这样定义的：Employee getEmployeeByName(String fullName) 那么：  
第一，首先要解决通讯的问题，主要是通过在客户端和服务器之间建立TCP连接（socket），远程过程调用的所有交换的数据都在这个连接里传输。连接可以是按需连接，调用结束后就断掉，也可以是长连接，多个远程过程调用共享同一个连接。  
第二，要解决寻址的问题，也就是说，A服务器上的应用怎么告诉底层的RPC框架，如何连接到B服务器（如主机或IP地址）以及特定的端口，方法的名称名称是什么，这样才能完成调用。比如基于Web服务协议栈的RPC，就要提供一个endpoint URI，或者是从UDDI服务上查找。如果是RMI调用的话，还需要一个RMI Registry来注册服务的地址。  
第三，当A服务器上的应用发起远程过程调用时，方法的参数需要通过底层的网络协议如TCP传递到B服务器，由于网络协议是基于二进制的，内存中的参数的值要序列化成二进制的形式，也就是序列化（Serialize）或编组（marshal），通过寻址和传输将序列化的二进制发送给B服务器。
第四，B服务器收到请求后，需要对参数进行反序列化（序列化的逆操作），恢复为内存中的表达方式，然后找到对应的方法（寻址的一部分）进行本地调用，然后得到返回值。  
第五，返回值还要发送回服务器A上的应用，也要经过序列化的方式发送，服务器A接到后，再反序列化，恢复为内存中的表达方式，交给A服务器上的应用。

# day02 RPC与协议

RPC是一种概念，HTTP是RPC实现的一种方式。  
类似于基于HTTP协议的Web服务，可以理解为浏览器客户端调用Web服务端的方法并将获取服务端返回的数据，该过程与RPC基本一致，RPC的目的也是想要通过本地调用实现远程调用并获取远程调用的数据，而本质上本地没有远程的方法是无法实现本地调用远程调用的，因此RPC框架使用起来像是在调用远程的方法，其底层还是与远程服务通信，通知其调用目标方法并返回数据的。RPC框架对底层细节进行了封装，使用起来对底层无感知，像是在直接调用远程方法一样。

协议定义了网络通信的规范，RPC是基于协议之上的高层建筑，根据不同的协议，诞生了不同的RPC框架。
